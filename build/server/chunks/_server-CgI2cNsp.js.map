{"version":3,"file":"_server-CgI2cNsp.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/players/_server.js"],"sourcesContent":["import Database from \"better-sqlite3\";\nimport { j as json } from \"../../../../chunks/index.js\";\nasync function GET() {\n  const db = new Database(\"players.db\");\n  db.exec(`\n        CREATE TABLE IF NOT EXISTS players (\n            id INTEGER PRIMARY KEY,\n            name TEXT,\n            points INTEGER,\n            numberOfGames INTEGER\n        )\n    `);\n  const count = db.prepare(\"SELECT COUNT(*) as count FROM players\").get().count;\n  if (count === 0) {\n    const insert = db.prepare(\n      \"INSERT INTO players (name, points, numberOfGames) VALUES (?, ?, ?)\"\n    );\n    [\n      [\"Gerrie\", 300, 2],\n      [\"Romi\", 0, 2]\n    ].forEach((player) => insert.run(player));\n  }\n  const players = db.prepare(\"SELECT * FROM players ORDER BY points DESC\").all();\n  db.close();\n  return json(players);\n}\nasync function POST({ request }) {\n  const db = new Database(\"players.db\");\n  try {\n    const { name } = await request.json();\n    if (!name) {\n      return new Response(JSON.stringify({ error: \"Name is required\" }), {\n        status: 400,\n        headers: { \"Content-Type\": \"application/json\" }\n      });\n    }\n    const insert = db.prepare(\n      \"INSERT INTO players (name, points, numberOfGames) VALUES (?, ?, ?)\"\n    );\n    const info = insert.run(name, 0, 0);\n    const newPlayer = db.prepare(\"SELECT * FROM players WHERE id = ?\").get(info.lastInsertRowid);\n    db.close();\n    return json(newPlayer);\n  } catch (error) {\n    console.error(\"Error in POST /api/players:\", error);\n    return new Response(JSON.stringify({ error: \"Internal Server Error\" }), {\n      status: 500,\n      headers: { \"Content-Type\": \"application/json\" }\n    });\n  }\n}\nasync function DELETE({ params }) {\n  const db = new Database(\"players.db\");\n  try {\n    const { id } = params;\n    if (!id) {\n      console.error(\"DELETE request missing id parameter\");\n      return new Response(JSON.stringify({ error: \"Missing id parameter\" }), {\n        status: 400,\n        headers: { \"Content-Type\": \"application/json\" }\n      });\n    }\n    console.log(`Attempting to delete player with id: ${id}`);\n    const deleteStmt = db.prepare(\"DELETE FROM players WHERE id = ?\");\n    const result = deleteStmt.run(id);\n    console.log(`Delete operation result:`, result);\n    db.close();\n    if (result.changes === 0) {\n      console.log(`No player found with id: ${id}`);\n      return new Response(JSON.stringify({ error: \"Player not found\" }), {\n        status: 404,\n        headers: { \"Content-Type\": \"application/json\" }\n      });\n    }\n    console.log(`Successfully deleted player with id: ${id}`);\n    return new Response(null, { status: 204 });\n  } catch (error) {\n    console.error(\"Error in DELETE /api/players:\", error);\n    return new Response(\n      JSON.stringify({\n        error: \"Internal Server Error\",\n        details: error.message\n      }),\n      {\n        status: 500,\n        headers: { \"Content-Type\": \"application/json\" }\n      }\n    );\n  }\n}\nexport {\n  DELETE,\n  GET,\n  POST\n};\n"],"names":[],"mappings":"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"}